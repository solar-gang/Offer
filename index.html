<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
  <title>Leverage Our Sun • Solar + Storage</title>

  <style>
    :root{
      --night:#06122a;
      --night2:#040b1c;
      --text: rgba(255,255,255,.94);
      --muted: rgba(255,255,255,.72);
      --muted2: rgba(255,255,255,.56);
      --border: rgba(255,255,255,.14);
      --shadow: 0 18px 70px rgba(0,0,0,.48);

      --sun2:#ff7a00;
      --lime:#8cff3f;
      --cyan:#00c2ff;

      --red:#ff3b30;
      --green:#34c759;
      --blue:#00c2ff;

      --r:18px;
      --r2:22px;

      --grad: linear-gradient(135deg, var(--sun2), var(--lime), var(--cyan));
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    html{scroll-behavior:smooth; scroll-padding-top:96px;}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color:var(--text);
      background:
        radial-gradient(900px 520px at 16% 10%, rgba(255,122,0,.22), transparent 58%),
        radial-gradient(900px 520px at 46% 40%, rgba(140,255,63,.10), transparent 58%),
        radial-gradient(900px 520px at 84% 12%, rgba(0,194,255,.20), transparent 55%),
        linear-gradient(180deg, var(--night), var(--night2));
    }
    a{color:#cfe8ff;text-decoration:none}
    a:hover{text-decoration:underline}
    a, button { -webkit-tap-highlight-color: transparent; }

    .topbar{
      position:fixed; inset:0 0 auto 0;
      background:rgba(4,10,22,.62);
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
      border-bottom:1px solid rgba(255,255,255,.14);
      z-index:50;
      padding-top: env(safe-area-inset-top);
    }
    .topbar-inner{
      max-width:1200px;
      margin:0 auto;
      padding:12px 18px;
      padding-left: calc(18px + env(safe-area-inset-left));
      padding-right: calc(18px + env(safe-area-inset-right));
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:12px;
      flex-wrap:wrap;
    }
    .brand{display:flex; align-items:center; gap:12px; min-width:280px;}
    .brand img{height:42px; width:auto; display:block;}
    .brandText{display:flex; flex-direction:column; line-height:1.15;}
    .brandTitle{font-weight:950; letter-spacing:-.02em; display:flex; align-items:center; gap:10px;}
    .brandGlow{
      width:10px;height:10px;border-radius:999px;
      background: var(--grad);
      box-shadow: 0 0 0 6px rgba(255,122,0,.10), 0 0 24px rgba(0,194,255,.26);
    }
    .brandSub{color:var(--muted2); font-size:12.5px; margin-top:2px;}
    .nav{display:flex; gap:10px; align-items:center; flex-wrap:wrap;}

    .btn{
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      color: var(--text);
      padding:12px 14px;
      border-radius: 12px;
      font-weight: 900;
      cursor:pointer;
      min-height:44px;
      line-height:1;
      transition: transform .12s ease, background .12s ease, box-shadow .12s ease;
      touch-action: manipulation;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:8px;
    }
    .btn:hover{background: rgba(255,255,255,.10); transform: translateY(-1px); box-shadow: 0 12px 40px rgba(0,0,0,.25);}
    .btn.primary{
      background: var(--grad);
      border-color: rgba(255,255,255,.18);
      color: #06101e;
      box-shadow: 0 14px 50px rgba(0,194,255,.12), 0 14px 50px rgba(255,122,0,.10);
    }

    .container{
      max-width:1200px;
      margin:0 auto;
      padding: calc(92px + env(safe-area-inset-top)) 18px calc(84px + env(safe-area-inset-bottom));
      padding-left: calc(18px + env(safe-area-inset-left));
      padding-right: calc(18px + env(safe-area-inset-right));
    }

    .hero{
      border:1px solid rgba(255,255,255,.14);
      background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04));
      border-radius: var(--r2);
      box-shadow: var(--shadow);
      padding:18px;
      display:grid;
      grid-template-columns: 1.25fr .9fr;
      gap:14px;
      overflow:hidden;
      position:relative;
    }
    .hero::before{
      content:"";
      position:absolute; inset:-2px;
      background:
        radial-gradient(700px 300px at 20% 20%, rgba(255,122,0,.14), transparent 60%),
        radial-gradient(700px 300px at 80% 20%, rgba(0,194,255,.12), transparent 60%),
        radial-gradient(700px 300px at 55% 90%, rgba(140,255,63,.10), transparent 60%);
      pointer-events:none;
      filter: blur(2px);
    }
    .hero > *{position:relative; z-index:1;}
    h1{margin:0; font-size: clamp(22px, 3.2vw, 38px); letter-spacing:-.04em; line-height:1.06;}
    .gradText{background: var(--grad); -webkit-background-clip:text; background-clip:text; color:transparent; font-weight:1000;}
    .hero p{margin:10px 0 0; color:var(--muted); line-height:1.45; max-width: 820px;}
    .heroActions{margin-top:14px; display:flex; gap:10px; flex-wrap:wrap;}

    .card{
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      border-radius: var(--r);
      padding:14px;
      box-shadow: 0 12px 35px rgba(0,0,0,.25);
    }

    .fieldGrid{display:grid; grid-template-columns: 1fr 1fr; gap:10px;}
    label span{
      display:block;
      color:var(--muted2);
      font-size:11.5px;
      letter-spacing:.06em;
      text-transform:uppercase;
      margin-bottom:6px;
    }
    input{
      width:100%;
      padding:12px 12px;
      border-radius: 12px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.22);
      color: var(--text);
      font-weight: 900;
      outline:none;
      min-height:44px;
      font-size:16px;
    }
    input:focus{
      border-color: rgba(0,194,255,.65);
      box-shadow: 0 0 0 6px rgba(0,194,255,.14);
    }

    .section{
      margin-top: 18px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.05);
      border-radius: var(--r2);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .sectionHead{
      padding:16px 18px;
      border-bottom:1px solid rgba(255,255,255,.12);
      background: linear-gradient(180deg, rgba(255,255,255,.07), rgba(255,255,255,.03));
      display:flex;
      justify-content:space-between;
      gap:14px;
      flex-wrap:wrap;
      align-items:center;
    }
    .sectionHead h2{margin:0; font-size:15px; display:flex; align-items:center; gap:10px;}
    .spark{
      width:10px;height:10px;border-radius:999px;
      background: var(--grad);
      box-shadow: 0 0 22px rgba(255,122,0,.18), 0 0 22px rgba(0,194,255,.16);
    }
    .sectionBody{padding:18px;}

    .grid12{display:grid; grid-template-columns: repeat(12, 1fr); gap:14px;}
    .span5{grid-column: span 5;}
    .span7{grid-column: span 7;}
    .span12{grid-column: span 12;}

    figure.bill{
      margin:0;
      border:1px solid rgba(255,255,255,.14);
      border-radius: var(--r);
      background: rgba(0,0,0,.20);
      overflow:hidden;
    }
    figure.bill img{
      width:100%;
      height:auto;
      display:block;
      cursor: zoom-in;
      background:#fff;
      -webkit-user-select:none;
      user-select:none;
    }

    .rateExplosion{
      border:1px solid rgba(255,59,48,.28);
      background: rgba(255,59,48,.10);
      border-radius: var(--r);
      padding:14px;
      height:100%;
      display:flex;
      flex-direction:column;
      justify-content:center;
      gap:10px;
      box-shadow: 0 12px 35px rgba(0,0,0,.20);
    }
    .rateExplosion .small{
      color: rgba(255,255,255,.80);
      font-weight:900;
      letter-spacing:.06em;
      text-transform:uppercase;
      font-size:11px;
    }
    .rateExplosion .row{
      display:flex; justify-content:space-between; gap:10px; flex-wrap:wrap;
      color: rgba(255,255,255,.88);
      font-weight:1000;
      font-size:16px;
    }
    .rateExplosion .row span{color: rgba(255,255,255,.70); font-weight:900;}
    .rateExplosion .delta{
      margin-top:4px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.18);
      border-radius: 14px;
      padding:10px 12px;
      display:flex;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      font-weight:1000;
    }
    .rateExplosion .delta .v{color: var(--red); font-size:18px;}

    .videoShell{
      border-radius: var(--r);
      overflow:hidden;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.35);
      box-shadow: 0 18px 70px rgba(0,0,0,.35);
      position:relative;
    }
    video{width:100%; height:auto; display:block; background:#000;}
    .videoOverlay{
      position:absolute; inset:0;
      display:none;
      align-items:center;
      justify-content:center;
      background: linear-gradient(180deg, rgba(0,0,0,.35), rgba(0,0,0,.65));
      padding:18px;
      text-align:center;
    }
    .videoOverlay.open{display:flex;}
    .videoOverlay .panel{
      max-width:560px;
      border:1px solid rgba(255,255,255,.18);
      background: rgba(8,12,22,.85);
      border-radius: 18px;
      padding:14px;
      box-shadow: 0 18px 70px rgba(0,0,0,.55);
    }
    .videoOverlay .panel .t{
      font-weight:1000;
      letter-spacing:-.02em;
      font-size:18px;
      margin-bottom:10px;
    }
    .videoOverlay .panel .s{
      color: rgba(255,255,255,.78);
      line-height:1.35;
      margin-bottom:12px;
      font-weight:800;
      font-size:13.5px;
    }
    .videoOverlay .panel .actions{
      display:flex; gap:10px; flex-wrap:wrap; justify-content:center;
    }

    .columns{display:grid; grid-template-columns: repeat(3, 1fr); gap:12px;}
    .col{
      border:1px solid rgba(255,255,255,.14);
      border-radius: var(--r);
      background: rgba(255,255,255,.04);
      overflow:hidden;
    }
    .colHead{
      padding:12px;
      border-bottom:1px solid rgba(255,255,255,.10);
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      background: rgba(255,255,255,.05);
    }
    .colLabel{color:var(--muted2); text-transform:uppercase; letter-spacing:.06em; font-size:11px;}
    .colTitle{font-weight:1000; font-size:18px; letter-spacing:-.02em; margin-top:2px;}
    .chip{
      border:1px solid rgba(255,255,255,.16);
      background: rgba(0,0,0,.18);
      border-radius:999px;
      padding:6px 10px;
      font-size:12px;
      color:var(--muted);
      font-weight:900;
      white-space:nowrap;
    }
    .col.utility .colHead{background: linear-gradient(180deg, rgba(255,59,48,.20), rgba(255,255,255,.05));}
    .col.opt1 .colHead{background: linear-gradient(180deg, rgba(52,199,89,.18), rgba(255,255,255,.05));}
    .col.opt2 .colHead{background: linear-gradient(180deg, rgba(0,194,255,.18), rgba(255,255,255,.05));}

    .totals{
      padding:12px;
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
      border-top:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.12);
    }
    .metric{
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.04);
      border-radius: 12px;
      padding:10px;
    }
    .metric .k{
      color:var(--muted2);
      font-size:11.5px;
      text-transform:uppercase;
      letter-spacing:.06em;
    }
    .metric .v{
      margin-top:6px;
      font-weight:1000;
      font-size:18px;
      letter-spacing:-.02em;
    }

    .pickerWrap{
      margin-top:14px;
      border:1px solid rgba(255,255,255,.14);
      border-radius: var(--r2);
      background: rgba(255,255,255,.04);
      overflow:hidden;
    }
    .pickerHead{
      padding:14px 16px;
      border-bottom:1px solid rgba(255,255,255,.10);
      background: linear-gradient(135deg, rgba(255,122,0,.10), rgba(140,255,63,.06), rgba(0,194,255,.08));
      display:flex;
      justify-content:space-between;
      flex-wrap:wrap;
      gap:10px;
      align-items:center;
    }
    .pickerHead .title{
      font-weight:1000;
      letter-spacing:-.02em;
      display:flex;
      align-items:center;
      gap:10px;
    }
    .yearPill{
      display:inline-flex; align-items:center; gap:10px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.05);
      border-radius:999px;
      padding:8px 10px;
      font-weight:1000;
    }
    .yearPill .dot{width:10px;height:10px;border-radius:999px;background: var(--grad);}

    .pickerBody{
      padding:16px;
      display:grid;
      grid-template-columns: 0.8fr 1.2fr;
      gap:12px;
      align-items:stretch;
    }

    /* Smooth: native scroll snap "wheel" */
    .yearWheel{
      border:1px solid rgba(255,255,255,.14);
      border-radius: var(--r);
      background: rgba(0,0,0,.20);
      padding:12px;
      position:relative;
      overflow:hidden;
      min-height: 280px;
    }
    .wheelViewport{
      height: 280px;
      overflow-y:auto;
      -webkit-overflow-scrolling: touch;
      scroll-snap-type: y mandatory;
      scrollbar-width:none;
      touch-action: pan-y;
    }
    .wheelViewport::-webkit-scrollbar{width:0;height:0}
    .wheelItem{
      height:56px;
      display:flex;
      align-items:center;
      justify-content:center;
      scroll-snap-align: center;
      font-weight:1000;
      letter-spacing:-.03em;
      font-size: 42px;
      color: rgba(255,255,255,.75);
    }
    .wheelItem.active{
      color: rgba(255,255,255,.95);
      text-shadow: 0 10px 40px rgba(0,194,255,.18);
    }
    .wheelMaskTop,
    .wheelMaskBottom{
      position:absolute; left:0; right:0; height:84px; pointer-events:none;
    }
    .wheelMaskTop{top:0; background: linear-gradient(180deg, rgba(4,11,28,.95), rgba(4,11,28,0));}
    .wheelMaskBottom{bottom:0; background: linear-gradient(0deg, rgba(4,11,28,.95), rgba(4,11,28,0));}
    .wheelCenterLine{
      position:absolute; left:12px; right:12px; top:50%;
      height:56px;
      transform: translateY(-50%);
      border-radius: 14px;
      border: 1px solid rgba(0,194,255,.28);
      background: rgba(0,194,255,.08);
      pointer-events:none;
      box-shadow: 0 12px 40px rgba(0,0,0,.25);
    }

    .comparePanel{
      border:1px solid rgba(255,255,255,.14);
      border-radius: var(--r);
      background: rgba(0,0,0,.20);
      padding:12px;
      display:grid;
      gap:12px;
    }
    .compareGrid{display:grid; grid-template-columns: repeat(3, 1fr); gap:10px;}
    .bigTile{
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.04);
      border-radius: 16px;
      padding:12px;
    }
    .bigTile .k{
      color:var(--muted2);
      font-size:11.5px;
      text-transform:uppercase;
      letter-spacing:.06em;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    .labelChip{
      border:1px solid rgba(255,255,255,.14);
      border-radius:999px;
      padding:6px 10px;
      font-weight:1000;
      background: rgba(0,0,0,.18);
      color: rgba(255,255,255,.86);
      white-space:nowrap;
    }
    .moneyBig{
      margin-top:10px;
      font-size: clamp(34px, 5.2vw, 56px);
      font-weight: 1000;
      letter-spacing:-.03em;
      line-height:1.0;
    }
    .moneyBig.red{color:var(--red)}
    .moneyBig.green{color:var(--green)}
    .moneyBig.blue{color:var(--blue)}
    .subLine{margin-top:8px; color: var(--muted); font-size: 13px; line-height:1.25;}

    .savingsLine{
      border:1px solid rgba(52,199,89,.30);
      background: rgba(52,199,89,.10);
      border-radius: 14px;
      padding:10px 12px;
      display:flex;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      font-weight:1000;
    }
    .savingsLine .sVal{color: var(--green); font-size:18px;}

    .tableWrap{
      margin-top:12px;
      border:1px solid rgba(255,255,255,.14);
      border-radius: var(--r);
      overflow:auto;
      -webkit-overflow-scrolling: touch;
      background: rgba(0,0,0,.16);
    }
    table{
      width:100%;
      min-width: 680px;
      border-collapse:collapse;
      font-size:13px;
    }
    thead th{
      text-align:left;
      padding:10px 10px;
      color:var(--muted);
      background: rgba(255,255,255,.06);
      border-bottom:1px solid rgba(255,255,255,.10);
      position:sticky; top:0;
    }
    tbody td{
      padding:9px 10px;
      border-bottom:1px solid rgba(255,255,255,.06);
      color: rgba(255,255,255,.88);
      white-space: nowrap;
    }
    tr.activeYear td{ background: rgba(0,194,255,.10); }

    /* Timeline slide */
    .timeline{
      display:grid;
      gap:12px;
    }
    .timelineGrid{
      display:grid;
      grid-template-columns: repeat(6, 1fr);
      gap:10px;
    }
    .step{
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.18);
      border-radius: 16px;
      padding:12px;
      position:relative;
      overflow:hidden;
      min-height: 110px;
    }
    .step::before{
      content:"";
      position:absolute; inset:-2px;
      background: radial-gradient(240px 120px at 30% 30%, rgba(255,122,0,.12), transparent 60%),
                  radial-gradient(240px 120px at 80% 30%, rgba(0,194,255,.10), transparent 60%),
                  radial-gradient(240px 120px at 50% 90%, rgba(140,255,63,.08), transparent 60%);
      filter: blur(2px);
      pointer-events:none;
    }
    .step > *{position:relative; z-index:1;}
    .step .n{
      width:28px;height:28px;border-radius:999px;
      background: var(--grad);
      color:#06101e;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      font-weight:1000;
      margin-bottom:10px;
    }
    .step .t{font-weight:1000; letter-spacing:-.02em;}
    .step .d{margin-top:8px; color:rgba(255,255,255,.78); font-weight:900;}
    .timelineBar{
      height:10px;
      border-radius:999px;
      background: rgba(255,255,255,.08);
      overflow:hidden;
      border:1px solid rgba(255,255,255,.10);
    }
    .timelineBar .fill{
      height:100%;
      width:100%;
      background: var(--grad);
      opacity:.9;
    }

    .lightbox{
      position:fixed; inset:0;
      background: rgba(0,0,0,.80);
      display:none;
      align-items:center;
      justify-content:center;
      padding: 22px;
      padding-top: calc(22px + env(safe-area-inset-top));
      padding-bottom: calc(22px + env(safe-area-inset-bottom));
      z-index:200;
    }
    .lightbox.open{display:flex;}
    .lightbox-inner{
      max-width:min(1100px, 96vw);
      max-height: 92vh;
      background: rgba(8,12,22,.94);
      border:1px solid rgba(255,255,255,.18);
      border-radius: 16px;
      overflow:hidden;
      box-shadow: 0 30px 120px rgba(0,0,0,.55);
    }
    .lightbox-bar{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      padding:10px 12px;
      border-bottom:1px solid rgba(255,255,255,.10);
      color: var(--muted);
      font-weight:900;
      font-size: 13px;
    }
    .lightbox-bar button{
      min-height:44px;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.06);
      color: var(--text);
      border-radius: 12px;
      padding:8px 12px;
      cursor:pointer;
      font-weight:900;
    }
    .lightbox img{width:100%; height:auto; display:block; background:#fff;}

    @media (max-width: 980px){
      .hero{grid-template-columns: 1fr;}
      .span5,.span7,.span12{grid-column: span 12;}
      .fieldGrid{grid-template-columns: 1fr;}
      .columns{grid-template-columns: 1fr;}
      .pickerBody{grid-template-columns: 1fr;}
      .compareGrid{grid-template-columns: 1fr;}
      .timelineGrid{grid-template-columns: 1fr;}
    }
  </style>
</head>

<body>
  <div class="topbar">
    <div class="topbar-inner">
      <div class="brand">
        <img id="brandLogo" src="" alt="Leverage Our Sun logo">
        <div class="brandText">
          <div class="brandTitle"><span class="brandGlow"></span> Leverage Our Sun</div>
          <div class="brandSub">Solar + Storage Presentation</div>
        </div>
      </div>
      <div class="nav">
        <a class="btn" href="#tou">TOU</a>
        <a class="btn" href="#vpp">VPP</a>
        <a class="btn" href="#outage">Outage</a>
        <a class="btn" href="#compare">Compare</a>
        <a class="btn primary" href="#timeline">Timeline</a>
        <button class="btn" id="btnReset" type="button">Reset</button>
      </div>
    </div>
  </div>

  <main class="container">
    <section class="hero">
      <div>
        <h1>Win the day. <span class="gradText">Own the night.</span></h1>
        <p>TOU + Net Billing makes batteries the difference.</p>
        <div class="heroActions">
          <a class="btn primary" href="#compare">Show the savings</a>
          <a class="btn" href="#outage">Show backup power</a>
        </div>
      </div>

      <div class="card">
        <div class="fieldGrid">
          <label><span>Homeowner</span><input id="custName" placeholder="John & Jane"></label>
          <label><span>City</span><input id="custCity" placeholder="Murrieta"></label>
          <label><span>Goal</span><input id="custGoal" placeholder="Lower bill + backup"></label>
          <label><span>Notes</span><input id="custNotes" placeholder="EV / pool / A/C"></label>
        </div>
      </div>
    </section>

    <section class="section" id="tou">
      <div class="sectionHead">
        <h2><span class="spark"></span> Time-of-Use</h2>
        <div style="display:flex; gap:10px; flex-wrap:wrap;">
          <a class="btn" target="_blank" rel="noreferrer" href="https://www.sce.com/save-money/rates-financing/residential-rate-plans/time-of-use-plans">SCE TOU Plans</a>
          <a class="btn" target="_blank" rel="noreferrer" href="https://www.sce.com/save-money/rates-financing/sce-rate-advisory">SCE Rate Changes</a>
        </div>
      </div>

      <div class="sectionBody grid12" id="bills">
        <div class="span7">
          <figure class="bill">
            <img id="imgUtilityOnly" src="" alt="SCE utility-only bill" data-zoom-title="Utility Bill (No Solar)" />
          </figure>
        </div>
        <div class="span5">
          <div class="rateExplosion">
            <div class="small">Rates exploded (15 years)</div>
            <div class="row"><span>Then</span><b>$0.17 / kWh</b></div>
            <div class="row"><span>Now</span><b>$0.42 / kWh</b></div>
            <div class="delta"><div>Increase</div><div class="v">+147%</div></div>
          </div>
        </div>

        <div class="span12">
          <figure class="bill">
            <img id="imgSolarNetBilling" src="" alt="SCE solar net billing bill" data-zoom-title="Solar Net Billing Bill" />
          </figure>
        </div>
      </div>
    </section>

    <section class="section" id="vpp">
      <div class="sectionHead">
        <h2><span class="spark"></span> Tesla Virtual Power Plant</h2>
        <div style="display:flex; gap:10px; flex-wrap:wrap;">
          <a class="btn" target="_blank" rel="noreferrer" href="https://www.tesla.com/support/energy/virtual-power-plant/sce">Tesla VPP (SCE)</a>
          <a class="btn" target="_blank" rel="noreferrer" href="https://www.tesla.com/support/energy/powerwall/learn/incentives">Incentives</a>
        </div>
      </div>
      <div class="sectionBody">
        <div class="card" style="display:flex; align-items:center; justify-content:space-between; gap:12px; flex-wrap:wrap;">
          <div style="font-weight:1000; font-size:18px; letter-spacing:-.02em;">Extra value on top of savings + backup.</div>
          <a class="btn primary" target="_blank" rel="noreferrer" href="https://www.tesla.com/support/energy/virtual-power-plant/sce">See VPP</a>
        </div>
      </div>
    </section>

    <section class="section" id="outage">
      <div class="sectionHead">
        <h2><span class="spark"></span> Outage Demo</h2>
        <div style="display:flex; gap:10px; flex-wrap:wrap;">
          <a class="btn primary" id="openOutageLink" target="_blank" rel="noreferrer" href="#">Open Video</a>
          <a class="btn" href="#compare">Compare</a>
        </div>
      </div>

      <div class="sectionBody">
        <div class="videoShell">
          <video id="outageVideo" controls playsinline preload="metadata" muted>
            <source id="outageMov" src="" type="video/quicktime">
          </video>

          <div class="videoOverlay" id="videoOverlay">
            <div class="panel">
              <div class="t">Outage Demo</div>
              <div class="s">Tap “Open Video” to play in a new window.</div>
              <div class="actions">
                <a class="btn primary" id="openOutageLink2" target="_blank" rel="noreferrer" href="#">Open Video</a>
                <button class="btn" type="button" id="hideOverlay">Close</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="section" id="compare">
      <div class="sectionHead">
        <h2><span class="spark"></span> Compare</h2>
        <div style="display:flex; gap:10px; flex-wrap:wrap;">
          <button class="btn" type="button" data-jump="1">Year 1</button>
          <button class="btn" type="button" data-jump="5">Year 5</button>
          <button class="btn" type="button" data-jump="10">Year 10</button>
          <button class="btn" type="button" data-jump="25">Year 25</button>
        </div>
      </div>

      <div class="sectionBody">
        <div class="columns">
          <div class="col utility">
            <div class="colHead">
              <div>
                <div class="colLabel">Utility</div>
                <div class="colTitle">Edison</div>
              </div>
              <div class="chip">Red</div>
            </div>
            <div style="padding:12px;display:grid;gap:10px;">
              <label><span>Avg monthly bill ($)</span><input id="uPay" value="458" inputmode="decimal"></label>
              <label><span>Annual increase (%)</span><input id="uEsc" value="9" inputmode="decimal"></label>
            </div>
            <div class="totals">
              <div class="metric"><div class="k">25-Year total</div><div class="v" style="color:var(--red)" id="uTotal">$0</div></div>
              <div class="metric"><div class="k">Year 25 monthly</div><div class="v" id="uY25">$0</div></div>
            </div>
          </div>

          <div class="col opt1">
            <div class="colHead">
              <div>
                <div class="colLabel">Option 1</div>
                <div class="colTitle">Solar + Battery</div>
              </div>
              <div class="chip">Green</div>
            </div>
            <div style="padding:12px;display:grid;gap:10px;">
              <label><span>Avg monthly payment ($)</span><input id="o1Pay" value="295" inputmode="decimal"></label>
              <label><span>Annual escalator (%)</span><input id="o1Esc" value="3.5" inputmode="decimal"></label>
            </div>
            <div class="totals">
              <div class="metric"><div class="k">25-Year total</div><div class="v" id="o1Total">$0</div></div>
              <div class="metric"><div class="k">Savings vs utility</div><div class="v" style="color:var(--green)" id="o1Save">$0</div></div>
            </div>
          </div>

          <div class="col opt2">
            <div class="colHead">
              <div>
                <div class="colLabel">Option 2</div>
                <div class="colTitle">Solar + Battery</div>
              </div>
              <div class="chip">Blue</div>
            </div>
            <div style="padding:12px;display:grid;gap:10px;">
              <label><span>Avg monthly payment ($)</span><input id="o2Pay" value="310" inputmode="decimal"></label>
              <label><span>Annual escalator (%)</span><input id="o2Esc" value="0" inputmode="decimal"></label>
            </div>
            <div class="totals">
              <div class="metric"><div class="k">25-Year total</div><div class="v" id="o2Total">$0</div></div>
              <div class="metric"><div class="k">Savings vs utility</div><div class="v" style="color:var(--green)" id="o2Save">$0</div></div>
            </div>
          </div>
        </div>

        <div class="pickerWrap">
          <div class="pickerHead">
            <div class="title">
              <span style="width:10px;height:10px;border-radius:999px;background:var(--grad);display:inline-block;box-shadow:0 0 22px rgba(0,194,255,.16);"></span>
              Annual Comparison
            </div>
            <div class="yearPill"><span class="dot"></span> Year <span id="yearLabel">1</span></div>
          </div>

          <div class="pickerBody">
            <div class="yearWheel">
              <div class="wheelCenterLine"></div>
              <div class="wheelMaskTop"></div>
              <div class="wheelMaskBottom"></div>
              <div class="wheelViewport" id="yearViewport" aria-label="Year selector (scroll)"></div>
            </div>

            <div class="comparePanel">
              <div class="compareGrid">
                <div class="bigTile">
                  <div class="k">Utility <span class="labelChip" style="border-color:rgba(255,59,48,.35);">Red</span></div>
                  <div class="moneyBig red" id="uYearMonthly">$0</div>
                  <div class="subLine" id="uYearAnnual">Annual: $0</div>
                </div>

                <div class="bigTile">
                  <div class="k">Option 1 <span class="labelChip" style="border-color:rgba(52,199,89,.35);">Green</span></div>
                  <div class="moneyBig green" id="o1YearMonthly">$0</div>
                  <div class="subLine" id="o1YearAnnual">Annual: $0</div>
                </div>

                <div class="bigTile">
                  <div class="k">Option 2 <span class="labelChip" style="border-color:rgba(0,194,255,.35);">Blue</span></div>
                  <div class="moneyBig blue" id="o2YearMonthly">$0</div>
                  <div class="subLine" id="o2YearAnnual">Annual: $0</div>
                </div>
              </div>

              <div class="savingsLine">
                <div>Savings (Best Option vs Utility)</div>
                <div class="sVal" id="yearSavings">$0</div>
              </div>
            </div>
          </div>
        </div>

        <div class="tableWrap" aria-label="25-year table">
          <table>
            <thead>
              <tr>
                <th style="width:70px">Year</th>
                <th>Utility Monthly</th>
                <th>Option 1 Monthly</th>
                <th>Option 2 Monthly</th>
              </tr>
            </thead>
            <tbody id="rows"></tbody>
          </table>
        </div>
      </div>
    </section>

    <section class="section" id="timeline">
      <div class="sectionHead">
        <h2><span class="spark"></span> Project Timeline</h2>
        <div style="display:flex; gap:10px; flex-wrap:wrap;">
          <a class="btn" href="#compare">Back to compare</a>
        </div>
      </div>

      <div class="sectionBody timeline">
        <div class="timelineBar" aria-hidden="true"><div class="fill"></div></div>

        <div class="timelineGrid">
          <div class="step">
            <div class="n">1</div>
            <div class="t">Site Survey</div>
            <div class="d">&lt; 1 week</div>
          </div>

          <div class="step">
            <div class="n">2</div>
            <div class="t">Engineering</div>
            <div class="d">~ 1 week</div>
          </div>

          <div class="step">
            <div class="n">3</div>
            <div class="t">Permits</div>
            <div class="d">1–12 weeks</div>
          </div>

          <div class="step">
            <div class="n">4</div>
            <div class="t">Install Schedule</div>
            <div class="d">1 day–2 weeks</div>
          </div>

          <div class="step">
            <div class="n">5</div>
            <div class="t">Final Inspection</div>
            <div class="d">1–2 weeks</div>
          </div>

          <div class="step">
            <div class="n">6</div>
            <div class="t">PTO + First Payment</div>
            <div class="d">PTO 30–60 days • 1st payment 1 month after PTO</div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <div class="lightbox" id="lightbox" role="dialog" aria-modal="true">
    <div class="lightbox-inner">
      <div class="lightbox-bar">
        <div id="lightboxTitle">Preview</div>
        <button id="lightboxClose" type="button">Close</button>
      </div>
      <img id="lightboxImg" alt="Zoomed image"/>
    </div>
  </div>

  <script>
    const LOGO_URL = "https://raw.githubusercontent.com/solar-gang/Storage-presentation/main/4A5B0E0C-50D9-4752-8469-F61A667110D8.png";
    const UTILITY_ONLY_BILL_URL = "https://raw.githubusercontent.com/solar-gang/Storage-presentation/main/IMG_8578.jpeg";
    const SOLAR_NET_BILLING_BILL_URL = "https://raw.githubusercontent.com/solar-gang/Storage-presentation/main/IMG_9100.jpeg";
    const OUTAGE_VIDEO_URL_MOV = "https://raw.githubusercontent.com/solar-gang/Storage-presentation/main/RecordIt-1770162136.mov";

    const $ = (id) => document.getElementById(id);
    const clamp = (n,a,b)=>Math.max(a,Math.min(b,n));
    function toNumber(val){
      const n = parseFloat(String(val).replace(/[^0-9.\-]/g,''));
      return Number.isFinite(n) ? n : 0;
    }
    function money0(n){
      const x = Number.isFinite(n) ? n : 0;
      return x.toLocaleString(undefined, { style:'currency', currency:'USD', maximumFractionDigits: 0 });
    }
    function money2(n){
      const x = Number.isFinite(n) ? n : 0;
      return x.toLocaleString(undefined, { style:'currency', currency:'USD', maximumFractionDigits: 2 });
    }

    $('brandLogo').src = LOGO_URL;
    $('imgUtilityOnly').src = UTILITY_ONLY_BILL_URL;
    $('imgSolarNetBilling').src = SOLAR_NET_BILLING_BILL_URL;

    // Lightbox
    const lb = $('lightbox'), lbImg = $('lightboxImg'), lbTitle = $('lightboxTitle');
    function openLightbox(src, title){ lbImg.src = src; lbTitle.textContent = title || 'Preview'; lb.classList.add('open'); }
    function closeLightbox(){ lb.classList.remove('open'); lbImg.src = ''; }
    document.querySelectorAll('img[data-zoom-title]').forEach(img => {
      img.addEventListener('click', () => img.src && openLightbox(img.src, img.dataset.zoomTitle));
    });
    $('lightboxClose').addEventListener('click', closeLightbox);
    lb.addEventListener('click', (e)=>{ if(e.target===lb) closeLightbox(); });
    document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') closeLightbox(); });

    // Video: always allow new-window playback (works even if inline fails)
    const open1 = $('openOutageLink');
    const open2 = $('openOutageLink2');
    open1.href = OUTAGE_VIDEO_URL_MOV;
    open2.href = OUTAGE_VIDEO_URL_MOV;

    const vid = $('outageVideo');
    const src = $('outageMov');
    const overlay = $('videoOverlay');
    const hideOverlay = $('hideOverlay');

    src.src = OUTAGE_VIDEO_URL_MOV;
    vid.load();

    function showOverlay(){ overlay.classList.add('open'); }
    function hideOv(){ overlay.classList.remove('open'); }

    vid.addEventListener('error', showOverlay);
    vid.addEventListener('stalled', showOverlay);
    vid.addEventListener('emptied', showOverlay);
    vid.addEventListener('canplay', hideOv);

    setTimeout(() => {
      if (vid.readyState < 2) showOverlay();
    }, 900);

    hideOverlay.addEventListener('click', hideOv);

    // Calculator math
    function monthlyByYear(baseMonthly, annualEscPct, years=25){
      const esc = annualEscPct / 100;
      const arr = [];
      for(let y=1; y<=years; y++) arr.push(baseMonthly * Math.pow(1+esc, y-1));
      return arr;
    }
    function total25yr(baseMonthly, annualEscPct){
      const series = monthlyByYear(baseMonthly, annualEscPct, 25);
      return series.reduce((sum, m) => sum + (m*12), 0);
    }

    let cache = { uSeries:Array(25).fill(0), o1Series:Array(25).fill(0), o2Series:Array(25).fill(0) };
    let selectedYear = 1;

    function updateYearPanel(year){
      selectedYear = clamp(year, 1, 25);
      $('yearLabel').textContent = String(selectedYear);

      document.querySelectorAll('#rows tr').forEach(tr => tr.classList.remove('activeYear'));
      const tr = document.querySelector(`#rows tr[data-year="${selectedYear}"]`);
      if(tr) tr.classList.add('activeYear');

      const idx = selectedYear - 1;
      const uM = cache.uSeries[idx] ?? 0;
      const o1M = cache.o1Series[idx] ?? 0;
      const o2M = cache.o2Series[idx] ?? 0;

      $('uYearMonthly').textContent = money2(uM);
      $('o1YearMonthly').textContent = money2(o1M);
      $('o2YearMonthly').textContent = money2(o2M);

      $('uYearAnnual').textContent = `Annual: ${money0(uM*12)}`;
      $('o1YearAnnual').textContent = `Annual: ${money0(o1M*12)}`;
      $('o2YearAnnual').textContent = `Annual: ${money0(o2M*12)}`;

      const best = Math.min(o1M, o2M);
      const savings = (uM - best) * 12;
      $('yearSavings').textContent = money0(savings);
      $('yearSavings').style.color = savings >= 0 ? 'var(--green)' : 'var(--red)';

      document.querySelectorAll('.wheelItem').forEach(el => el.classList.remove('active'));
      const active = document.querySelector(`.wheelItem[data-year="${selectedYear}"]`);
      if(active) active.classList.add('active');
    }

    function render(){
      const uPay = toNumber($('uPay').value), uEsc = toNumber($('uEsc').value);
      const o1Pay = toNumber($('o1Pay').value), o1Esc = toNumber($('o1Esc').value);
      const o2Pay = toNumber($('o2Pay').value), o2Esc = toNumber($('o2Esc').value);

      cache.uSeries = monthlyByYear(uPay, uEsc, 25);
      cache.o1Series = monthlyByYear(o1Pay, o1Esc, 25);
      cache.o2Series = monthlyByYear(o2Pay, o2Esc, 25);

      const uTotal = total25yr(uPay, uEsc);
      const o1Total = total25yr(o1Pay, o1Esc);
      const o2Total = total25yr(o2Pay, o2Esc);

      $('uTotal').textContent = money0(uTotal);
      $('o1Total').textContent = money0(o1Total);
      $('o2Total').textContent = money0(o2Total);

      const s1 = uTotal - o1Total;
      const s2 = uTotal - o2Total;
      $('o1Save').textContent = money0(s1);
      $('o2Save').textContent = money0(s2);
      $('o1Save').style.color = s1 >= 0 ? 'var(--green)' : 'var(--red)';
      $('o2Save').style.color = s2 >= 0 ? 'var(--green)' : 'var(--red)';

      $('uY25').textContent = money2(cache.uSeries[24]);

      const tbody = $('rows');
      tbody.innerHTML = '';
      for(let y=1; y<=25; y++){
        const tr = document.createElement('tr');
        tr.dataset.year = String(y);
        tr.innerHTML = `
          <td>${y}</td>
          <td>${money2(cache.uSeries[y-1])}</td>
          <td>${money2(cache.o1Series[y-1])}</td>
          <td>${money2(cache.o2Series[y-1])}</td>
        `;
        tbody.appendChild(tr);
      }
      updateYearPanel(selectedYear);
    }

    // Build smooth year "wheel"
    const viewport = $('yearViewport');
    function buildWheel(){
      viewport.innerHTML = '';
      // top spacer
      for(let i=0;i<2;i++){
        const sp = document.createElement('div');
        sp.className = 'wheelItem';
        sp.textContent = '';
        viewport.appendChild(sp);
      }
      for(let y=1; y<=25; y++){
        const div = document.createElement('div');
        div.className = 'wheelItem';
        div.dataset.year = String(y);
        div.textContent = String(y);
        div.addEventListener('click', () => scrollToYear(y));
        viewport.appendChild(div);
      }
      // bottom spacer
      for(let i=0;i<2;i++){
        const sp = document.createElement('div');
        sp.className = 'wheelItem';
        sp.textContent = '';
        viewport.appendChild(sp);
      }
    }

    let wheelTick = null;
    function snapFromScroll(){
      const items = Array.from(viewport.querySelectorAll('.wheelItem[data-year]'));
      if(items.length === 0) return;

      const rect = viewport.getBoundingClientRect();
      const centerY = rect.top + rect.height/2;

      let best = { y: 1, dist: Infinity };
      for(const it of items){
        const r = it.getBoundingClientRect();
        const mid = r.top + r.height/2;
        const d = Math.abs(mid - centerY);
        if(d < best.dist){ best = { y: parseInt(it.dataset.year,10), dist: d }; }
      }
      updateYearPanel(best.y);
    }

    function scrollToYear(year){
      const el = viewport.querySelector(`.wheelItem[data-year="${year}"]`);
      if(!el) return;
      const top = el.offsetTop - (viewport.clientHeight/2) + (el.clientHeight/2);
      viewport.scrollTo({ top, behavior: 'smooth' });
      updateYearPanel(year);
    }

    viewport.addEventListener('scroll', () => {
      if(wheelTick) cancelAnimationFrame(wheelTick);
      wheelTick = requestAnimationFrame(snapFromScroll);
    }, { passive:true });

    // Sync all 3 escalators
    function syncEscFrom(sourceId){
      const v = toNumber($(sourceId).value);
      $('uEsc').value = String(v);
      $('o1Esc').value = String(v);
      $('o2Esc').value = String(v);
      render();
    }
    $('uEsc').addEventListener('input', ()=>syncEscFrom('uEsc'));
    $('o1Esc').addEventListener('input', ()=>syncEscFrom('o1Esc'));
    $('o2Esc').addEventListener('input', ()=>syncEscFrom('o2Esc'));

    // Quick year buttons
    document.querySelectorAll('button[data-jump]').forEach(btn=>{
      btn.addEventListener('click', () => scrollToYear(parseInt(btn.dataset.jump,10)));
    });

    // Reset
    $('btnReset').addEventListener('click', () => {
      $('uPay').value = '458'; $('uEsc').value = '9';
      $('o1Pay').value = '295'; $('o1Esc').value = '3.5';
      $('o2Pay').value = '310'; $('o2Esc').value = '0';
      selectedYear = 1;
      render();
      scrollToYear(1);
    });

    // Init
    buildWheel();
    render();
    // position at year 1 after layout
    requestAnimationFrame(()=>scrollToYear(1));
  </script>
</body>
</html>
