<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Solar + Storage | Guided Presentation</title>
  <meta name="description" content="Sales + Learning modes. Big-slide presentation with synced early inputs + large calculator + proof links." />

  <style>
    :root{
      /* Premium dark + clean neon accents (NOT salesy) */
      --bg0:#05070F;
      --bg1:#070A14;
      --panel:rgba(255,255,255,.06);
      --panel2:rgba(255,255,255,.09);
      --stroke:rgba(255,255,255,.12);
      --text:rgba(255,255,255,.92);
      --muted:rgba(255,255,255,.72);
      --muted2:rgba(255,255,255,.56);
      --shadow:0 26px 90px rgba(0,0,0,.60);
      --radius:20px;

      /* Utility theme defaults (swapped via JS) */
      --utilityA:#D1202E; /* SCE red */
      --utilityB:#FFCF36; /* SCE gold */
      --utilityShort:"SCE";

      /* Proposal theme (calm + premium) */
      --proposalA:#34D399; /* emerald */
      --proposalB:#60A5FA; /* blue */
      --proposalC:#A78BFA; /* purple */

      --good:#22C55E;
      --bad:#EF4444;

      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";

      /* Sizing (bigger UX) */
      --max:1280px;
      --pad:18px;
      --btnPad:14px 16px;
      --btnRad:16px;
      --h2:40px;
      --p:18px;
      --input:18px;
      --big:22px;
      --bigger:30px;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family:var(--sans);
      color:var(--text);
      background:
        radial-gradient(1200px 650px at 15% 10%, rgba(96,165,250,.14), transparent 55%),
        radial-gradient(900px 550px at 85% 15%, rgba(167,139,250,.14), transparent 55%),
        radial-gradient(1000px 650px at 50% 110%, rgba(34,197,94,.10), transparent 60%),
        linear-gradient(180deg, var(--bg0) 0%, var(--bg1) 55%, var(--bg0) 100%);
      overflow-x:hidden;
    }

    a{ color:rgba(255,255,255,.92); text-decoration:none; }
    a:hover{ text-decoration:underline; }

    .wrap{ max-width:var(--max); margin:0 auto; padding:16px 16px 84px; }

    /* ---------- Topbar ---------- */
    .topbar{
      position:sticky; top:12px; z-index:60;
      border:1px solid var(--stroke);
      border-radius:24px;
      background:linear-gradient(180deg, rgba(255,255,255,.09), rgba(255,255,255,.05));
      backdrop-filter: blur(10px);
      box-shadow: var(--shadow);
      padding:12px 12px;
      display:flex; gap:12px; align-items:center; justify-content:space-between;
      flex-wrap:wrap;
    }

    .brand{ display:flex; gap:12px; align-items:center; }
    .mark{
      width:44px; height:44px; border-radius:16px;
      background:
        radial-gradient(circle at 25% 30%, rgba(255,255,255,.22), transparent 52%),
        linear-gradient(135deg, var(--proposalB), rgba(34,197,94,.72));
      border: 1px solid rgba(255,255,255,.16);
      box-shadow:0 18px 60px rgba(0,0,0,.45);
      position:relative;
    }
    .mark:after{
      content:"";
      position:absolute; inset:10px;
      border-radius:12px;
      border:1px solid rgba(255,255,255,.18);
      opacity:.55;
    }
    .brand h1{ margin:0; font-size:14px; letter-spacing:.2px; font-weight:820; line-height:1.1; }
    .brand p{ margin:2px 0 0; font-size:12.5px; color:var(--muted2); }

    .controls{ display:flex; gap:10px; align-items:center; flex-wrap:wrap; }

    .pill{
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.05);
      border-radius:999px;
      padding:12px 12px;
      display:flex; gap:10px; align-items:center;
      box-shadow: inset 0 1px 0 rgba(255,255,255,.06);
    }

    select, input[type="text"], input[type="number"]{
      font:inherit;
      color:var(--text);
      background:transparent;
      border:0;
      outline:none;
    }
    select{ cursor:pointer; font-weight:760; }

    .btn{
      cursor:pointer;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.06);
      color:var(--text);
      padding:var(--btnPad);
      border-radius:var(--btnRad);
      font-weight:800;
      letter-spacing:.2px;
      box-shadow: inset 0 1px 0 rgba(255,255,255,.08);
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
      user-select:none;
      white-space:nowrap;
      font-size:14px;
    }
    .btn:hover{ transform:translateY(-1px); background:rgba(255,255,255,.09); border-color:rgba(255,255,255,.26); }
    .btn:active{ transform:translateY(0); }

    .toggle{
      display:flex; align-items:center; gap:0;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.18);
      border-radius:999px;
      overflow:hidden;
    }
    .toggle button{
      border:0; background:transparent; color:var(--muted);
      padding:12px 14px; cursor:pointer; font-weight:860; letter-spacing:.2px;
      font-size:14px;
    }
    .toggle button.active{
      background: rgba(255,255,255,.12);
      color: rgba(255,255,255,.94);
    }

    /* ---------- Deck ---------- */
    .deck{
      margin-top:14px;
      border:1px solid var(--stroke);
      border-radius:28px;
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      box-shadow: var(--shadow);
      overflow:hidden;
    }

    .deck-top{
      padding:12px 14px;
      display:flex; align-items:center; justify-content:space-between; gap:12px;
      border-bottom:1px solid rgba(255,255,255,.09);
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      flex-wrap:wrap;
    }

    .progress{
      flex: 1;
      height:12px;
      border-radius:999px;
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
      overflow:hidden;
      min-width:200px;
    }
    .bar{
      height:100%;
      width:0%;
      background: linear-gradient(90deg, var(--proposalB), var(--proposalA));
      border-radius:999px;
      transition: width .2s ease;
    }

    .dots{ display:flex; gap:7px; align-items:center; }
    .dot{
      width:9px; height:9px; border-radius:50%;
      background: rgba(255,255,255,.22);
      border: 1px solid rgba(255,255,255,.20);
      cursor:pointer;
    }
    .dot.active{ background: rgba(255,255,255,.88); border-color: rgba(255,255,255,.36); }

    .deck-body{ padding:18px; }

    .slide{
      display:none;
      border:1px solid rgba(255,255,255,.11);
      border-radius:24px;
      background:
        radial-gradient(520px 280px at 18% 12%, rgba(255,255,255,.10), transparent 62%),
        radial-gradient(460px 260px at 86% 18%, rgba(255,255,255,.06), transparent 62%),
        rgba(0,0,0,.18);
      padding:24px;
      min-height: 480px;
    }
    .slide.active{ display:block; }

    .slide h2{
      margin:0 0 10px;
      font-size:var(--h2);
      letter-spacing:-.9px;
      line-height:1.05;
    }
    .slide p{
      margin:0 0 14px;
      color:var(--muted);
      font-size:var(--p);
      line-height:1.65;
      max-width: 92ch;
    }

    .bigline{
      margin-top:14px;
      border-radius:20px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.05);
      padding:16px;
      font-size:19px;
      color: rgba(255,255,255,.88);
      line-height:1.55;
    }
    .bigline strong{ color: rgba(255,255,255,.95); }

    .two-col{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:14px;
      margin-top:14px;
    }
    @media (max-width: 980px){
      :root{ --h2:32px; --p:17px; }
      .two-col{ grid-template-columns: 1fr; }
      .slide{ min-height:unset; }
    }

    .tile{
      border-radius:20px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.18);
      padding:16px;
    }
    .tile .k{ font-size:12.5px; color:var(--muted2); letter-spacing:.25px; }
    .tile .v{ margin-top:8px; font-size:28px; font-weight:920; letter-spacing:-.35px; }
    .tile .h{ margin-top:8px; font-size:14px; color:var(--muted); line-height:1.6; }

    .nav{
      display:flex; gap:10px; align-items:center; justify-content:space-between;
      margin-top:16px;
      flex-wrap:wrap;
    }
    .nav .left, .nav .right{ display:flex; gap:10px; align-items:center; }

    .kbd{
      font-family: var(--mono);
      font-size: 12px;
      color: rgba(255,255,255,.72);
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.04);
      border-radius: 12px;
      padding: 10px 12px;
      white-space:nowrap;
    }

    /* ---------- Learning Mode ---------- */
    .learn{ margin-top: 14px; display:none; }
    .learn.active{ display:block; }

    .grid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 14px;
    }
    @media (max-width: 980px){ .grid{ grid-template-columns: 1fr; } }

    .card{
      border:1px solid var(--stroke);
      border-radius: var(--radius);
      background: rgba(255,255,255,.05);
      box-shadow: 0 24px 80px rgba(0,0,0,.45);
      overflow:hidden;
    }
    .card-h{
      padding: 14px 14px 10px;
      border-bottom: 1px solid rgba(255,255,255,.08);
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
    }
    .card-h h3{ margin:0; font-size:14px; letter-spacing:.25px; }
    .card-h p{ margin:6px 0 0; color:var(--muted); font-size:13px; line-height:1.5; }
    .card-b{ padding: 12px 14px 14px; }

    .callout{
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.16);
      border-radius: 16px;
      padding: 12px;
      color: var(--muted);
      font-size: 13.5px;
      line-height: 1.7;
    }
    .callout strong{ color: rgba(255,255,255,.92); }

    .src{
      margin-top:10px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.16);
      border-radius: 14px;
      padding: 12px;
      display:flex; gap:10px; justify-content:space-between; align-items:flex-start;
      color: var(--muted);
      font-size: 13px;
    }
    .tag{
      font-size: 11px;
      padding: 7px 9px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.12);
      color: rgba(255,255,255,.74);
      white-space:nowrap;
      background: rgba(255,255,255,.04);
      height: fit-content;
    }

    /* ---------- Calculator (BIGGER) ---------- */
    .calc-grid{
      display:grid;
      grid-template-columns: 1.2fr 1fr 1fr;
      gap: 14px;
      margin-top: 12px;
    }
    @media (max-width: 980px){ .calc-grid{ grid-template-columns: 1fr; } }

    .col{
      border: 1px solid rgba(255,255,255,.12);
      border-radius: 22px;
      background: rgba(0,0,0,.18);
      padding: 14px;
      position: relative;
      overflow:hidden;
      min-height: 360px;
    }
    .col:before{
      content:"";
      position:absolute; inset:-60px -60px auto auto;
      width:220px; height:220px; border-radius:50%;
      opacity:.16;
    }
    .col.utility:before{ background: radial-gradient(circle at 40% 40%, var(--utilityB), transparent 66%); }
    .col.a:before{ background: radial-gradient(circle at 40% 40%, var(--proposalA), transparent 66%); }
    .col.b:before{ background: radial-gradient(circle at 40% 40%, var(--proposalB), transparent 66%); }

    .colhead{ display:flex; align-items:center; justify-content:space-between; gap:10px; margin-bottom:12px; }
    .colhead h4{ margin:0; font-size:14px; letter-spacing:.2px; font-weight:900; }
    .chip{
      font-size: 12px;
      padding: 7px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.04);
      color: rgba(255,255,255,.84);
      white-space:nowrap;
    }

    .form{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
    .field{
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.05);
      border-radius:18px;
      padding:12px;
    }
    .field.full{ grid-column:1 / -1; }
    .field label{
      display:block;
      font-size:12px;
      color:var(--muted2);
      margin-bottom:8px;
      letter-spacing:.2px;
      font-weight:800;
    }
    .field input{
      width:100%;
      font-weight:920;
      font-size:var(--input);
      padding: 6px 0;
    }
    .field small{
      display:block;
      margin-top:8px;
      color:var(--muted);
      font-size:12.5px;
      line-height:1.45;
    }

    .summary{
      margin-top:12px;
      border-radius:18px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.18);
      padding:12px;
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:12px;
      color:var(--muted);
      font-size:13px;
    }
    .big{
      font-size:var(--bigger);
      font-weight:980;
      letter-spacing:-.5px;
      color:rgba(255,255,255,.95);
      line-height:1.05;
    }
    .good{ color: var(--good); }
    .bad{ color: var(--bad); }
    .mono{ font-family: var(--mono); }

    /* Table */
    .tablewrap{
      margin-top:12px;
      border-radius: 18px;
      border:1px solid rgba(255,255,255,.10);
      overflow:hidden;
    }
    table{
      width:100%;
      border-collapse:collapse;
      font-size:13px;
      background: rgba(0,0,0,.16);
    }
    thead th{
      text-align:left; padding:12px;
      background: rgba(255,255,255,.05);
      border-bottom:1px solid rgba(255,255,255,.08);
      color: rgba(255,255,255,.88);
      font-weight:900;
      letter-spacing:.2px;
    }
    tbody td{
      padding:12px;
      border-bottom:1px solid rgba(255,255,255,.06);
      color: var(--muted);
    }

    .foot{
      margin-top: 14px;
      color: var(--muted2);
      font-size: 12px;
      line-height: 1.6;
      border-top: 1px solid rgba(255,255,255,.08);
      padding-top: 12px;
    }

    /* Modes */
    body.presentation .learn{ display:none !important; }
    body.learning .deck{ display:none !important; }

    /* Minimal customer view: hide advanced fields, but keep "proof" access */
    body.minimal .field:not(.essential){ display:none; }
    body.minimal .field small{ display:none; }

    /* Fullscreen tweaks */
    body.fullscreen .wrap{ padding-top: 10px; }
    body.fullscreen #topbar{ opacity: 0.05; transition: opacity .2s ease; }
    body.fullscreen #topbar:hover{ opacity: 1; }
    body.fullscreen .deck{ border-radius: 18px; }

    /* ---------- Proof Modal ---------- */
    .modal{
      position:fixed; inset:0; z-index:200;
      display:none;
      background: rgba(0,0,0,.62);
      backdrop-filter: blur(6px);
      padding: 18px;
    }
    .modal.active{ display:block; }
    .modal-card{
      max-width: 980px;
      margin: 0 auto;
      border:1px solid rgba(255,255,255,.14);
      border-radius: 22px;
      background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.05));
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .modal-h{
      padding: 14px 14px 12px;
      border-bottom:1px solid rgba(255,255,255,.10);
      display:flex; justify-content:space-between; gap:12px; align-items:center;
      flex-wrap:wrap;
    }
    .modal-h h3{
      margin:0;
      font-size: 14px;
      letter-spacing:.2px;
      font-weight: 920;
    }
    .modal-b{
      padding: 14px;
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
    @media (max-width: 880px){
      .modal-b{ grid-template-columns: 1fr; }
    }
    .proofbox{
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.16);
      border-radius: 16px;
      padding: 12px;
    }
    .proofbox h4{
      margin:0 0 8px;
      font-size: 12.5px;
      color: rgba(255,255,255,.86);
      letter-spacing:.2px;
    }
    .proofbox a{
      display:block;
      padding:10px 10px;
      border-radius: 12px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
      margin-top:8px;
      color: rgba(255,255,255,.90);
      font-size: 13px;
      line-height: 1.35;
    }
    .proofbox a:hover{ background: rgba(255,255,255,.07); text-decoration:none; }
    .proofnote{
      color: var(--muted);
      font-size: 12.5px;
      line-height: 1.6;
      margin-top: 10px;
    }
  </style>
</head>

<body class="presentation minimal">
  <div class="wrap">

    <!-- Topbar -->
    <div class="topbar" id="topbar">
      <div class="brand">
        <div class="mark" aria-hidden="true"></div>
        <div>
          <h1>Solar + Storage Presentation</h1>
          <p id="subline">Sales Mode • big slides • customer-friendly</p>
        </div>
      </div>

      <div class="controls">
        <div class="toggle" aria-label="Mode toggle">
          <button id="modePresentation" class="active" type="button">Sales</button>
          <button id="modeLearning" type="button">Learning</button>
        </div>

        <button class="btn" id="presentBtn" type="button" title="Fullscreen presenter mode">Presenter Fullscreen</button>
        <button class="btn" id="minimalBtn" type="button" title="Toggle minimal customer view">Customer View: ON</button>
        <button class="btn" id="proofBtn" type="button" title="Open proof links">Proof Links</button>

        <div class="pill" title="Select utility">
          <span style="color:var(--muted2); font-size:12px; letter-spacing:.2px;">Utility</span>
          <select id="utilitySelect" aria-label="Select utility">
            <option value="sce">SCE</option>
            <option value="pge">PG&E</option>
            <option value="sdge">SDG&E</option>
          </select>
        </div>

        <button class="btn" id="resetBtn" type="button">Reset</button>
      </div>
    </div>

    <!-- Deck -->
    <section class="deck" id="deck" aria-label="Presentation deck">
      <div class="deck-top">
        <div class="progress" aria-label="Slide progress"><div class="bar" id="bar"></div></div>
        <div class="dots" id="dots" aria-label="Slide dots"></div>
      </div>

      <div class="deck-body">
        <!-- Slide 1 -->
        <div class="slide active" data-title="Intro">
          <h2>Store the sun. Own the night.</h2>
          <p>
            We’ll keep this simple: why bills rise, why 4–9pm matters, how batteries solve it,
            and a clean 25-year comparison.
          </p>
          <div class="bigline">
            <strong>Trust rule:</strong> If we can’t show clear value and day-one savings, we stop and adjust.
          </div>
          <div class="nav">
            <div class="left">
              <span class="kbd">Use → / ← • Press F for fullscreen</span>
            </div>
            <div class="right">
              <button class="btn" data-next type="button">Next</button>
            </div>
          </div>
        </div>

        <!-- Slide 2: Early Inputs (NEW) -->
        <div class="slide" data-title="Confirm">
          <h2>First: confirm the numbers</h2>
          <p>
            We agree on your real average monthly bill and a reasonable annual increase.
            These inputs automatically populate the calculator.
          </p>

          <div class="two-col">
            <div class="tile">
              <div class="k">Customer average monthly bill</div>
              <div class="v" id="kpiBillSlide">$—</div>
              <div class="h">Enter it once here — it syncs everywhere.</div>
            </div>
            <div class="tile">
              <div class="k">Annual increase (agreed)</div>
              <div class="v"><span id="kpiEscSlide">—</span>%</div>
              <div class="h">We’ll keep it honest and source-based.</div>
            </div>
          </div>

          <div style="margin-top:14px; display:grid; grid-template-columns: 1fr 1fr; gap:14px;">
            <div class="field full essential" style="padding:16px; border-radius:20px;">
              <label style="font-size:13px;">Monthly bill ($)</label>
              <input id="uMonthlyEarly" type="number" min="0" step="1" placeholder="e.g., 320" style="font-size:22px; font-weight:980;" />
              <small style="font-size:13px;">This will populate Utility → Monthly bill.</small>
            </div>
            <div class="field full essential" style="padding:16px; border-radius:20px;">
              <label style="font-size:13px;">Annual increase (%)</label>
              <input id="uEscEarly" type="number" min="0" step="0.1" placeholder="e.g., 6.0" style="font-size:22px; font-weight:980;" />
              <small style="font-size:13px;">This will populate Utility → Annual increase.</small>
            </div>
          </div>

          <div class="bigline">
            <strong>Proof is always available:</strong> tap <strong>Proof Links</strong> in the top bar anytime.
          </div>

          <div class="nav">
            <div class="left"><button class="btn" data-prev type="button">Back</button></div>
            <div class="right"><button class="btn" data-next type="button">Next</button></div>
          </div>
        </div>

        <!-- Slide 3 -->
        <div class="slide" data-title="Problem">
          <h2>The problem: electricity keeps getting more expensive</h2>
          <p>
            Utilities raise rates for grid upgrades, infrastructure, wildfire hardening, and system costs.
            Without solar + storage, your bill stays exposed.
          </p>

          <div class="two-col">
            <div class="tile">
              <div class="k">Customer avg bill (today)</div>
              <div class="v" id="kpiBillSlide2">$—</div>
              <div class="h">Based on what you confirmed.</div>
            </div>
            <div class="tile">
              <div class="k">What this means</div>
              <div class="v">Rising cost over time</div>
              <div class="h">The compounding effect is the real problem.</div>
            </div>
          </div>

          <div class="nav">
            <div class="left"><button class="btn" data-prev type="button">Back</button></div>
            <div class="right"><button class="btn" data-next type="button">Next</button></div>
          </div>
        </div>

        <!-- Slide 4 -->
        <div class="slide" data-title="TOU">
          <h2>Time-of-Use: the daily 4–9pm penalty</h2>
          <p>
            TOU doesn’t just care how much you used — it cares <strong>when</strong>.
            Peak hours are when families are home.
          </p>

          <div class="two-col">
            <div class="tile">
              <div class="k">Peak window</div>
              <div class="v">4–9pm</div>
              <div class="h">Exact periods depend on plan/season.</div>
            </div>
            <div class="tile">
              <div class="k">Best simple explanation</div>
              <div class="v">Pay more at night</div>
              <div class="h">HVAC, cooking, EV charging get hit hardest.</div>
            </div>
          </div>

          <div class="nav">
            <div class="left"><button class="btn" data-prev type="button">Back</button></div>
            <div class="right"><button class="btn" data-next type="button">Next</button></div>
          </div>
        </div>

        <!-- Slide 5 -->
        <div class="slide" data-title="Storage">
          <h2>Storage solves TOU by shifting your power</h2>
          <p>
            Solar makes energy midday. Batteries let you use it at night — when power costs the most.
          </p>

          <div class="two-col">
            <div class="tile">
              <div class="k">One-liner</div>
              <div class="v">Battery = time shift</div>
              <div class="h">Store midday → use during peak.</div>
            </div>
            <div class="tile">
              <div class="k">Outcome</div>
              <div class="v">More control</div>
              <div class="h">Less dependence on peak pricing.</div>
            </div>
          </div>

          <div class="nav">
            <div class="left"><button class="btn" data-prev type="button">Back</button></div>
            <div class="right"><button class="btn" data-next type="button">Next</button></div>
          </div>
        </div>

        <!-- Slide 6 -->
        <div class="slide" data-title="Backup">
          <h2>Backup: when the neighborhood goes dark</h2>
          <p>
            Even if outages aren’t frequent, the first time it happens you immediately feel the value.
          </p>

          <div class="bigline">
            <strong>Customer moment:</strong> “Fridge, lights, Wi-Fi, phones, and essentials — staying on matters.”
          </div>

          <div class="bigline" id="outageBlock">
            <strong>Optional:</strong> Add your outage demo video in the code (Learning Mode explains).
          </div>

          <div class="nav">
            <div class="left"><button class="btn" data-prev type="button">Back</button></div>
            <div class="right"><button class="btn" data-next type="button">Next</button></div>
          </div>
        </div>

        <!-- Slide 7 -->
        <div class="slide" data-title="VPP">
          <h2>Tesla Virtual Power Plant: extra value if you opt in</h2>
          <p>
            A VPP is when many home batteries support the grid during events. Programs vary by utility and season.
          </p>

          <div class="bigline">
            <strong>Keep it factual:</strong> “If available and you opt in, it can add value while keeping your backup priorities.”
          </div>

          <div class="nav">
            <div class="left"><button class="btn" data-prev type="button">Back</button></div>
            <div class="right"><button class="btn" data-next type="button">Next</button></div>
          </div>
        </div>

        <!-- Slide 8 (Calculator) -->
        <div class="slide" data-title="Compare">
          <h2>25-year comparison</h2>
          <p>
            Utility vs two options. The “confirmed numbers” are already populated.
          </p>

          <div class="calc-grid">
            <!-- Utility -->
            <div class="col utility">
              <div class="colhead">
                <h4 id="utilityColTitle">Utility (SCE)</h4>
                <div class="chip">Baseline</div>
              </div>
              <div class="form">
                <div class="field full essential">
                  <label>Monthly bill ($)</label>
                  <input id="uMonthly" type="number" min="0" step="1" placeholder="e.g., 320" />
                  <small>Synced from Slide 2.</small>
                </div>
                <div class="field essential">
                  <label>Annual increase (%)</label>
                  <input id="uEsc" type="number" min="0" step="0.1" placeholder="e.g., 6.0" />
                  <small>Synced from Slide 2.</small>
                </div>
                <div class="field">
                  <label>Usage (kWh / month)</label>
                  <input id="uKwh" type="number" min="0" step="1" placeholder="e.g., 700" />
                  <small>Optional ¢/kWh estimate.</small>
                </div>
              </div>
              <div class="summary">
                <div>
                  <div style="color:var(--muted2); font-size:12px;">25-year total</div>
                  <div class="big" id="uTotal">$—</div>
                </div>
                <div>
                  <div style="color:var(--muted2); font-size:12px;">Est. ¢/kWh</div>
                  <div class="big" id="uCents">—</div>
                </div>
              </div>
            </div>

            <!-- Option A -->
            <div class="col a">
              <div class="colhead">
                <h4>Option A</h4>
                <div class="chip">Proposal 1</div>
              </div>
              <div class="form">
                <div class="field full essential">
                  <label>Monthly payment ($)</label>
                  <input id="aMonthly" type="number" min="0" step="1" placeholder="e.g., 255" />
                  <small>Enter your offer.</small>
                </div>
                <div class="field">
                  <label>Annual escalator (%)</label>
                  <input id="aEsc" type="number" min="0" step="0.1" placeholder="e.g., 0.0" />
                  <small>If any.</small>
                </div>
                <div class="field">
                  <label>Notes</label>
                  <input id="aNotes" type="text" placeholder="e.g., 1x PW3, fixed payment" />
                  <small>Optional.</small>
                </div>
              </div>
              <div class="summary">
                <div>
                  <div style="color:var(--muted2); font-size:12px;">25-year total</div>
                  <div class="big" id="aTotal">$—</div>
                </div>
                <div>
                  <div style="color:var(--muted2); font-size:12px;">Savings vs utility</div>
                  <div class="big" id="aSave">$—</div>
                </div>
              </div>
            </div>

            <!-- Option B -->
            <div class="col b">
              <div class="colhead">
                <h4>Option B</h4>
                <div class="chip">Proposal 2</div>
              </div>
              <div class="form">
                <div class="field full essential">
                  <label>Monthly payment ($)</label>
                  <input id="bMonthly" type="number" min="0" step="1" placeholder="e.g., 285" />
                  <small>Premium option.</small>
                </div>
                <div class="field">
                  <label>Annual escalator (%)</label>
                  <input id="bEsc" type="number" min="0" step="0.1" placeholder="e.g., 0.0" />
                  <small>If any.</small>
                </div>
                <div class="field">
                  <label>Notes</label>
                  <input id="bNotes" type="text" placeholder="e.g., more storage, max TOU control" />
                  <small>Optional.</small>
                </div>
              </div>
              <div class="summary">
                <div>
                  <div style="color:var(--muted2); font-size:12px;">25-year total</div>
                  <div class="big" id="bTotal">$—</div>
                </div>
                <div>
                  <div style="color:var(--muted2); font-size:12px;">Savings vs utility</div>
                  <div class="big" id="bSave">$—</div>
                </div>
              </div>
            </div>
          </div>

          <div class="bigline" style="margin-top:14px;">
            <strong>Trust rule:</strong> No day-one savings = we stop and adjust.
          </div>

          <div class="nav">
            <div class="left"><button class="btn" data-prev type="button">Back</button></div>
            <div class="right"><button class="btn" data-next type="button">Next</button></div>
          </div>
        </div>

        <!-- Slide 9 (Close) -->
        <div class="slide" data-title="Close">
          <h2>Close with clarity (not pressure)</h2>
          <p>
            “By the end of today you should have enough information to make an educated decision.
            If we can’t improve your situation, we won’t move forward.”
          </p>

          <div class="two-col">
            <div class="tile">
              <div class="k">Option A</div>
              <div class="v" id="closeA">—</div>
              <div class="h" id="closeANotes">—</div>
            </div>
            <div class="tile">
              <div class="k">Option B</div>
              <div class="v" id="closeB">—</div>
              <div class="h" id="closeBNotes">—</div>
            </div>
          </div>

          <div class="bigline">
            <strong>Next steps:</strong> qualify → site survey → final design review → permits after you sign off.
          </div>

          <div class="nav">
            <div class="left"><button class="btn" data-prev type="button">Back</button></div>
            <div class="right">
              <button class="btn" id="jumpToLearning" type="button">Open Learning Mode</button>
            </div>
          </div>
        </div>

      </div>
    </section>

    <!-- Learning Mode -->
    <section class="learn" id="learn">
      <div class="grid">

        <div class="card">
          <div class="card-h">
            <h3>Learning: Proof links (rates, TOU, base charges)</h3>
            <p>Use these when customers ask “where is that from?”</p>
          </div>
          <div class="card-b">
            <div class="callout">
              <strong>Rep line:</strong> “I’ll show you the actual utility and Tesla pages we’re referencing.”
            </div>
            <div id="learnProofRates"></div>
          </div>
        </div>

        <div class="card">
          <div class="card-h">
            <h3>Learning: Tesla VPP links</h3>
            <p>Keep it accurate: availability and compensation vary.</p>
          </div>
          <div class="card-b">
            <div class="callout">
              <strong>Rep line:</strong> “If it’s available for your utility and you opt in, it can add value while keeping backup priority.”
            </div>
            <div id="learnProofVpp"></div>
          </div>
        </div>

        <div class="card">
          <div class="card-h">
            <h3>Learning: Optional outage demo video</h3>
            <p>Paste a YouTube embed URL to show your blackout demo.</p>
          </div>
          <div class="card-b">
            <div class="callout">
              Edit this in the code:
              <div class="mono" style="margin-top:8px;">const OUTAGE_VIDEO_URL = "https://www.youtube.com/embed/VIDEO_ID";</div>
            </div>
          </div>
        </div>

        <div class="card" style="grid-column:1 / -1;">
          <div class="card-h">
            <h3>Learning: 25-year verification table</h3>
            <p>Full year-by-year math check.</p>
          </div>
          <div class="card-b">
            <div class="callout">
              Totals are year-by-year projections using the escalator rate you entered.
              Savings = Utility total − Option total.
            </div>
            <div class="tablewrap">
              <table aria-label="25-year projection table">
                <thead>
                  <tr>
                    <th style="width:70px;">Year</th>
                    <th id="thUtil">Utility</th>
                    <th>Option A</th>
                    <th>Option B</th>
                    <th>Savings A</th>
                    <th>Savings B</th>
                  </tr>
                </thead>
                <tbody id="tbody"></tbody>
              </table>
            </div>
            <div class="foot">
              <b>Disclaimer:</b> This is a sales tool, not legal/financial advice. Rates/programs can change by utility, plan, and season.
            </div>
          </div>
        </div>

      </div>
    </section>

  </div>

  <!-- Proof Modal (available in Sales + Learning) -->
  <div class="modal" id="modal">
    <div class="modal-card" role="dialog" aria-modal="true" aria-label="Proof Links">
      <div class="modal-h">
        <h3 id="modalTitle">Proof Links</h3>
        <div style="display:flex; gap:10px; align-items:center; flex-wrap:wrap;">
          <span class="kbd">Esc to close</span>
          <button class="btn" id="closeModalBtn" type="button">Close</button>
        </div>
      </div>
      <div class="modal-b">
        <div class="proofbox">
          <h4>Utility: TOU (Time-of-Use)</h4>
          <div id="proofTou"></div>
          <div class="proofnote">Use this when explaining 4–9pm peak periods.</div>
        </div>
        <div class="proofbox">
          <h4>Utility: ~13% increase</h4>
          <div id="proof13"></div>
          <div class="proofnote">Use this when addressing “why now?”</div>
        </div>
        <div class="proofbox">
          <h4>Utility: Base charge / Base Services Charge</h4>
          <div id="proofBase"></div>
          <div class="proofnote">Use this when explaining fixed charges on bills.</div>
        </div>
        <div class="proofbox">
          <h4>Tesla: Virtual Power Plant</h4>
          <div id="proofVpp"></div>
          <div class="proofnote">Use this when discussing VPP participation & compensation.</div>
        </div>
      </div>
    </div>
  </div>

  <script>
    /***************
      CONFIG (EDIT ME)
    ****************/
    // Optional: paste a YouTube embed URL (NOT a normal watch URL)
    // Example: https://www.youtube.com/embed/VIDEO_ID
    const OUTAGE_VIDEO_URL = "";

    /***************
      LINKS (Official where possible)
    ****************/
    const UTILITIES = {
      sce: {
        label: "Southern California Edison (SCE)",
        short: "SCE",
        colors: { A: "#D1202E", B: "#FFCF36" },
        proof: {
          tou: [
            { title: "SCE Time-of-Use Plans", url: "https://www.sce.com/save-money/rates-financing/residential-rate-plans/time-of-use-plans" }
          ],
          inc13: [
            { title: "SCE: Understanding updates to your bill (~13% increase)", url: "https://www.sce.com/save-money/rates-financing/residential-rate-plans/understanding-updates-to-your-bill" }
          ],
          base: [
            { title: "SCE: Base Service Charge overview", url: "https://www.sce.com/save-money/rates-financing/residential-rate-plans/bsc" },
            { title: "SCE: Base Services Charge & other charges", url: "https://www.sce.com/customer-service-center/help-center/rate-plans-pricing/base-services-charge/bsc-other-charges" }
          ],
          vpp: [
            { title: "Tesla VPP with SCE (DSGS)", url: "https://www.tesla.com/support/energy/virtual-power-plant/sce" }
          ]
        }
      },
      pge: {
        label: "PG&E",
        short: "PG&E",
        colors: { A: "#0071CE", B: "#FFD100" },
        proof: {
          tou: [
            { title: "PG&E residential rate plans (TOU info)", url: "https://www.pge.com/en/account/rate-plans.html" }
          ],
          inc13: [
            { title: "PG&E rate info / changes", url: "https://www.pge.com/en/account/rate-plans/rate-changes.html" }
          ],
          base: [
            { title: "PG&E bill & charges overview", url: "https://www.pge.com/en/account/billing-and-assistance/understand-your-bill.html" }
          ],
          vpp: [
            { title: "Tesla VPP with PG&E", url: "https://www.tesla.com/support/energy/virtual-power-plant/pge" }
          ]
        }
      },
      sdge: {
        label: "SDG&E",
        short: "SDG&E",
        colors: { A: "#00A6E7", B: "#9BE15D" },
        proof: {
          tou: [
            { title: "SDG&E rate plans (TOU info)", url: "https://www.sdge.com/residential/pricing-plans/about-our-pricing-plans/whenmatters" }
          ],
          inc13: [
            { title: "SDG&E rate info / changes", url: "https://www.sdge.com/residential/pricing-plans" }
          ],
          base: [
            { title: "SDG&E understanding your bill", url: "https://www.sdge.com/residential/customer-service/billing/payment/understanding-your-bill" }
          ],
          vpp: [
            { title: "Tesla VPP (DSGS California overview)", url: "https://www.tesla.com/support/energy/virtual-power-plant/dsgs" }
          ]
        }
      }
    };

    /***************
      HELPERS
    ****************/
    const $ = (id) => document.getElementById(id);
    const fmt$ = (n) => isFinite(n) ? n.toLocaleString(undefined,{style:"currency",currency:"USD",maximumFractionDigits:0}) : "—";
    const fmt$2 = (n) => isFinite(n) ? n.toLocaleString(undefined,{style:"currency",currency:"USD",maximumFractionDigits:2}) : "—";

    function projectTotal(monthly, escPct, years=25){
      const r = (escPct || 0) / 100;
      let total = 0;
      const rows = [];
      for(let y=1; y<=years; y++){
        const yearCost = (monthly * 12) * Math.pow(1+r, y-1);
        total += yearCost;
        rows.push({ y, yearCost });
      }
      return { total, rows };
    }
    function computeRows(utilRows, aRows, bRows){
      return utilRows.map((u, i) => {
        const a = aRows[i]?.yearCost ?? 0;
        const b = bRows[i]?.yearCost ?? 0;
        return { y:u.y, u:u.yearCost, a, b, sa:(u.yearCost - a), sb:(u.yearCost - b) };
      });
    }

    function setRootVar(key,val){ document.documentElement.style.setProperty(key, val); }

    function renderLinkList(container, links){
      container.innerHTML = "";
      links.forEach(x => {
        const a = document.createElement("a");
        a.href = x.url; a.target = "_blank"; a.rel = "noopener";
        a.textContent = x.title;
        container.appendChild(a);
      });
    }
    function renderSourcesBlocks(container, proof){
      container.innerHTML = `
        <div class="src"><div><a target="_blank" rel="noopener" href="${proof.tou[0].url}">${proof.tou[0].title}</a></div><div class="tag">SCE TOU</div></div>
        <div class="src"><div><a target="_blank" rel="noopener" href="${proof.inc13[0].url}">${proof.inc13[0].title}</a></div><div class="tag">~13%</div></div>
        <div class="src"><div><a target="_blank" rel="noopener" href="${proof.base[0].url}">${proof.base[0].title}</a></div><div class="tag">Base</div></div>
        ${proof.base[1] ? `<div class="src"><div><a target="_blank" rel="noopener" href="${proof.base[1].url}">${proof.base[1].title}</a></div><div class="tag">Base</div></div>` : ``}
      `;
    }
    function renderSourcesBlocksVpp(container, proof){
      container.innerHTML = `
        <div class="src"><div><a target="_blank" rel="noopener" href="${proof.vpp[0].url}">${proof.vpp[0].title}</a></div><div class="tag">Tesla VPP</div></div>
      `;
    }

    /***************
      DOM
    ****************/
    const modePresentation = $("modePresentation");
    const modeLearning = $("modeLearning");
    const subline = $("subline");
    const learn = $("learn");
    const jumpToLearning = $("jumpToLearning");

    const presentBtn = $("presentBtn");
    const minimalBtn = $("minimalBtn");
    const proofBtn = $("proofBtn");
    const resetBtn = $("resetBtn");

    const deck = $("deck");
    const utilitySelect = $("utilitySelect");
    const utilityColTitle = $("utilityColTitle");
    const thUtil = $("thUtil");

    // Early inputs
    const uMonthlyEarly = $("uMonthlyEarly");
    const uEscEarly = $("uEscEarly");
    const kpiBillSlide = $("kpiBillSlide");
    const kpiEscSlide = $("kpiEscSlide");
    const kpiBillSlide2 = $("kpiBillSlide2");

    // Calculator
    const uMonthly = $("uMonthly");
    const uEsc = $("uEsc");
    const uKwh = $("uKwh");

    const aMonthly = $("aMonthly");
    const aEsc = $("aEsc");
    const aNotes = $("aNotes");

    const bMonthly = $("bMonthly");
    const bEsc = $("bEsc");
    const bNotes = $("bNotes");

    const uTotal = $("uTotal");
    const uCents = $("uCents");
    const aTotal = $("aTotal");
    const bTotal = $("bTotal");
    const aSave = $("aSave");
    const bSave = $("bSave");

    const closeA = $("closeA");
    const closeB = $("closeB");
    const closeANotes = $("closeANotes");
    const closeBNotes = $("closeBNotes");

    // Learning sources
    const learnProofRates = $("learnProofRates");
    const learnProofVpp = $("learnProofVpp");

    // Table
    const tbody = $("tbody");

    // Slides
    const slides = Array.from(document.querySelectorAll(".slide"));
    const bar = $("bar");
    const dots = $("dots");

    // Proof modal
    const modal = $("modal");
    const modalTitle = $("modalTitle");
    const closeModalBtn = $("closeModalBtn");
    const proofTou = $("proofTou");
    const proof13 = $("proof13");
    const proofBase = $("proofBase");
    const proofVpp = $("proofVpp");

    const outageBlock = $("outageBlock");

    /***************
      STATE + SYNC (Early inputs -> calculator)
    ****************/
    function syncEarlyToCalc(){
      // If early fields have values, push into calculator
      if (uMonthlyEarly.value !== "" && document.activeElement !== uMonthly) uMonthly.value = uMonthlyEarly.value;
      if (uEscEarly.value !== "" && document.activeElement !== uEsc) uEsc.value = uEscEarly.value;
      updateKPIs();
      recalc();
    }

    function syncCalcToEarly(){
      // If calculator edited, keep early slide consistent
      if (uMonthly.value !== "" && document.activeElement !== uMonthlyEarly) uMonthlyEarly.value = uMonthly.value;
      if (uEsc.value !== "" && document.activeElement !== uEscEarly) uEscEarly.value = uEsc.value;
      updateKPIs();
    }

    function updateKPIs(){
      const m = parseFloat(uMonthly.value || uMonthlyEarly.value);
      const e = parseFloat(uEsc.value || uEscEarly.value);

      kpiBillSlide.textContent = (isFinite(m) && m>=0) ? fmt$(m) : "$—";
      kpiBillSlide2.textContent = (isFinite(m) && m>=0) ? fmt$(m) : "$—";
      kpiEscSlide.textContent = (isFinite(e) && e>=0) ? e.toFixed(1) : "—";

      const kwh = parseFloat(uKwh.value);
      let cents = NaN;
      if (isFinite(m) && m>0 && isFinite(kwh) && kwh>0) cents = (m / kwh) * 100;
      uCents.textContent = isFinite(cents) ? `${cents.toFixed(1)} ¢/kWh` : "—";
    }

    function updateClose(){
      const aM = parseFloat(aMonthly.value);
      const bM = parseFloat(bMonthly.value);

      closeA.textContent = isFinite(aM) ? `${fmt$(aM)}/mo` : "—";
      closeB.textContent = isFinite(bM) ? `${fmt$(bM)}/mo` : "—";
      closeANotes.textContent = aNotes.value?.trim() ? aNotes.value.trim() : "Add notes (battery count, fixed payment, etc.)";
      closeBNotes.textContent = bNotes.value?.trim() ? bNotes.value.trim() : "Add notes (more storage, max TOU control, etc.)";
    }

    function renderTable(rows){
      tbody.innerHTML = "";
      rows.forEach(r => {
        const tr = document.createElement("tr");
        const clsA = r.sa >= 0 ? "good" : "bad";
        const clsB = r.sb >= 0 ? "good" : "bad";
        tr.innerHTML = `
          <td class="mono">${r.y}</td>
          <td>${fmt$2(r.u)}</td>
          <td>${fmt$2(r.a)}</td>
          <td>${fmt$2(r.b)}</td>
          <td class="${clsA}">${fmt$2(r.sa)}</td>
          <td class="${clsB}">${fmt$2(r.sb)}</td>
        `;
        tbody.appendChild(tr);
      });
    }

    function recalc(){
      updateKPIs();
      updateClose();

      const uM = parseFloat(uMonthly.value);
      const uE = parseFloat(uEsc.value);
      const aM = parseFloat(aMonthly.value);
      const aE = parseFloat(aEsc.value);
      const bM = parseFloat(bMonthly.value);
      const bE = parseFloat(bEsc.value);

      const util = projectTotal(isFinite(uM)?uM:0, isFinite(uE)?uE:0, 25);
      const optA = projectTotal(isFinite(aM)?aM:0, isFinite(aE)?aE:0, 25);
      const optB = projectTotal(isFinite(bM)?bM:0, isFinite(bE)?bE:0, 25);

      uTotal.textContent = isFinite(uM) ? fmt$(util.total) : "$—";
      aTotal.textContent = isFinite(aM) ? fmt$(optA.total) : "$—";
      bTotal.textContent = isFinite(bM) ? fmt$(optB.total) : "$—";

      const saveA = util.total - optA.total;
      const saveB = util.total - optB.total;

      aSave.textContent = (isFinite(aM) && isFinite(uM)) ? fmt$(saveA) : "$—";
      bSave.textContent = (isFinite(bM) && isFinite(uM)) ? fmt$(saveB) : "$—";

      aSave.className = "big " + ((saveA>=0) ? "good" : "bad");
      bSave.className = "big " + ((saveB>=0) ? "good" : "bad");

      renderTable(computeRows(util.rows, optA.rows, optB.rows));
    }

    /***************
      Utility Switch + Proof Links
    ****************/
    function applyUtility(key){
      const u = UTILITIES[key] || UTILITIES.sce;

      setRootVar("--utilityA", u.colors.A);
      setRootVar("--utilityB", u.colors.B);
      setRootVar("--utilityShort", `"${u.short}"`);

      utilityColTitle.textContent = `Utility (${u.short})`;
      thUtil.textContent = `Utility (${u.short})`;
      modalTitle.textContent = `Proof Links • ${u.label}`;

      // Modal proof links
      renderLinkList(proofTou, u.proof.tou);
      renderLinkList(proof13, u.proof.inc13);
      renderLinkList(proofBase, u.proof.base);
      renderLinkList(proofVpp, u.proof.vpp);

      // Learning blocks
      renderSourcesBlocks(learnProofRates, u.proof);
      renderSourcesBlocksVpp(learnProofVpp, u.proof);

      outageBlock.textContent = OUTAGE_VIDEO_URL
        ? "Outage demo video is configured (great for this slide)."
        : "Optional: add your outage demo video in the code (Learning Mode explains).";

      recalc();
      updateDeckUI();
    }

    /***************
      Slides
    ****************/
    let idx = 0;

    function buildDots(){
      dots.innerHTML = "";
      slides.forEach((s, i) => {
        const d = document.createElement("div");
        d.className = "dot" + (i===idx ? " active" : "");
        d.title = s.dataset.title || `Slide ${i+1}`;
        d.addEventListener("click", () => go(i));
        dots.appendChild(d);
      });
    }

    function updateDeckUI(){
      slides.forEach((s,i)=> s.classList.toggle("active", i===idx));
      bar.style.width = (((idx+1)/slides.length)*100) + "%";
      Array.from(dots.children).forEach((d,i)=> d.classList.toggle("active", i===idx));
    }

    function go(i){
      idx = Math.max(0, Math.min(slides.length-1, i));
      updateDeckUI();
      deck?.scrollIntoView({behavior:"smooth", block:"start"});
    }
    function next(){ go(idx+1); }
    function prev(){ go(idx-1); }

    document.addEventListener("click", (e) => {
      const t = e.target;
      if (t && t.matches("[data-next]")) next();
      if (t && t.matches("[data-prev]")) prev();
    });

    document.addEventListener("keydown", (e) => {
      if (modal.classList.contains("active")){
        if (e.key === "Escape") closeModal();
        return;
      }
      if (document.body.classList.contains("presentation")){
        if (e.key === "ArrowRight") next();
        if (e.key === "ArrowLeft") prev();
        if (e.key.toLowerCase() === "f") toggleFullscreen();
      }
      if (e.key === "Escape") closeModal();
    });

    /***************
      Modes
    ****************/
    function setMode(mode){
      if (mode === "learning"){
        document.body.classList.remove("presentation");
        document.body.classList.add("learning");
        learn.classList.add("active");
        modeLearning.classList.add("active");
        modePresentation.classList.remove("active");
        subline.textContent = "Learning Mode • talk track + proof + math verification";
        window.scrollTo({top:0, behavior:"smooth"});
      } else {
        document.body.classList.add("presentation");
        document.body.classList.remove("learning");
        learn.classList.remove("active");
        modePresentation.classList.add("active");
        modeLearning.classList.remove("active");
        subline.textContent = "Sales Mode • big slides • customer-friendly";
        window.scrollTo({top:0, behavior:"smooth"});
      }
    }

    modePresentation.addEventListener("click", ()=> setMode("presentation"));
    modeLearning.addEventListener("click", ()=> setMode("learning"));
    jumpToLearning?.addEventListener("click", ()=> setMode("learning"));

    /***************
      Minimal customer view toggle
    ****************/
    function setMinimal(on){
      document.body.classList.toggle("minimal", !!on);
      minimalBtn.textContent = on ? "Customer View: ON" : "Customer View: OFF";
    }
    minimalBtn.addEventListener("click", ()=> {
      setMinimal(!document.body.classList.contains("minimal"));
    });

    /***************
      Fullscreen
    ****************/
    async function toggleFullscreen(){
      try{
        if (!document.fullscreenElement){
          await (deck || document.documentElement).requestFullscreen();
        } else {
          await document.exitFullscreen();
        }
      }catch(e){
        alert("Fullscreen isn't available on this device/browser. Try Safari/Chrome or rotate landscape.");
      }
    }
    presentBtn.addEventListener("click", toggleFullscreen);
    document.addEventListener("fullscreenchange", () => {
      const on = !!document.fullscreenElement;
      document.body.classList.toggle("fullscreen", on);
      presentBtn.textContent = on ? "Exit Fullscreen" : "Presenter Fullscreen";
    });

    /***************
      Proof Modal (Sales + Learning)
    ****************/
    function openModal(){ modal.classList.add("active"); }
    function closeModal(){ modal.classList.remove("active"); }
    proofBtn.addEventListener("click", openModal);
    closeModalBtn.addEventListener("click", closeModal);
    modal.addEventListener("click", (e)=>{ if (e.target === modal) closeModal(); });

    /***************
      Inputs sync
    ****************/
    // Early -> calc
    [uMonthlyEarly, uEscEarly].forEach(inp => inp.addEventListener("input", syncEarlyToCalc));
    // Calc -> early
    [uMonthly, uEsc].forEach(inp => inp.addEventListener("input", syncCalcToEarly));

    // Calculator inputs recalc
    [uKwh,aMonthly,aEsc,aNotes,bMonthly,bEsc,bNotes].forEach(inp => inp.addEventListener("input", recalc));

    utilitySelect.addEventListener("change", () => applyUtility(utilitySelect.value));

    /***************
      Reset
    ****************/
    function resetInputs(){
      uMonthlyEarly.value = ""; uEscEarly.value = "";
      uMonthly.value = ""; uEsc.value = ""; uKwh.value = "";
      aMonthly.value = ""; aEsc.value = ""; aNotes.value = "";
      bMonthly.value = ""; bEsc.value = ""; bNotes.value = "";
      recalc();
    }
    resetBtn.addEventListener("click", resetInputs);

    /***************
      Init
    ****************/
    buildDots();
    applyUtility("sce");
    setMode("presentation");
    setMinimal(true);
    recalc();
    updateDeckUI();
  </script>
</body>
</html>
